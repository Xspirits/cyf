<!doctype html>
<html>
<head>
	<% include statics/headers %>
	<title></title>
</head>
<body>

	<% include statics/navTop %>

	<div class="canvas">
		
		<div class="container">
			<div class="col-sm-8 col-sm-offset-2">

				<h1>Well met, <span id="whoAmI">challenger</span></h1>

				<% if (message) { %>
				<div class="alert alert-danger"><%= message %></div>
				<% } %>
				<% if (waitingConfirm) { %>
				<div class="alert alert-success"><strong>One last step!</strong> We sent you an email, please check your inbox and confirm your adress to enter the arena!</div>
				<% } else { %>



				<form action="/signup" id="rockstar" method="post">
					<div class="form-group">
						<label>Pseudo</label>
						<input type="text" class="form-control" name="pseudo">
					</div>
					<div class="form-group" id="emailVerify">
						<label>Email</label>
						<input type="text" class="form-control" id="txtEmail" name="email">
						<small>we will send you a confirmation email</small>
					</div>
					<div class="form-group">
						<label>Password</label>
						<input type="password" class="form-control" name="password"  placeholder="Password" pattern="^[a-zA-Z][a-zA-Z0-9-_\.]{1,12}$" data-validation-msg="Password must be 2-12 characters" required >
					</div>

					<button type="submit" id="createAccount" class="btn btn-block mint btn-lg">Signup</button>
				</form>

				<hr>
				<p><a href="/login" class="btn bittersweet btn-md">Already have an account? Enter the Arena!</a></p>

				<% } %>

			</div>
		</div>
	</div>
	<% include statics/footersFix %>

	<script type="text/javascript">

		$(function() {
			$('input[name="pseudo"]')
				.on('keyup', function () {
				    $("#whoAmI").text($(this).val()+"...");
				})
				.focusout(function() {
					var cooei = $(this).val();
				    $("#whoAmI").text(cooei);
				    $('#createAccount').text('I, '+cooei+', am ready!');
				});
			$('#createAccount').click(function(e) {
				e.preventDefault();
				var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
				var sEmail = $('#txtEmail').val();
				if (sEmail == '' || !re.test(sEmail)){
					console.log(!re.test(sEmail));

					$('#emailVerify').addClass('has-error')
				} 
				else {
					$('#rockstar').submit();
				}
			});

		});

	</script>

</body>
</html>